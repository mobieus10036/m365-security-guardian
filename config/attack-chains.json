{
  "version": "1.0.0",
  "description": "Attack chain definitions mapping M365 misconfigurations to exploitation paths",
  "attackChains": [
    {
      "id": "AC-001",
      "name": "Password Spray to Global Admin Takeover",
      "description": "Attacker compromises admin account via password spray, escalates to tenant control",
      "severity": "Critical",
      "tactics": ["Initial Access", "Privilege Escalation", "Persistence"],
      "mitreTechniques": ["T1110.003", "T1078.004", "T1098"],
      "killChainPhases": {
        "initialAccess": "Password spray against admin accounts lacking MFA",
        "execution": "Access Azure/M365 admin portals",
        "privilegeEscalation": "Already admin - no escalation needed",
        "persistence": "Create backdoor admin accounts or app registrations",
        "impact": "Full tenant compromise, data exfiltration, ransomware deployment"
      },
      "enablingConditions": [
        {
          "controlId": "1.2.1",
          "condition": "AdminMFAEnabled != Compliant",
          "weight": 40
        },
        {
          "controlId": "5.1.1.1",
          "condition": "LegacyAuthBlocked != Compliant",
          "weight": 30
        },
        {
          "controlId": "1.1.3",
          "condition": "GlobalAdminCount > 4",
          "weight": 15
        },
        {
          "controlId": "5.1.5.1",
          "condition": "PIMEnabled != Compliant",
          "weight": 15
        }
      ],
      "blastRadius": {
        "dataAtRisk": ["All tenant data", "Email content", "SharePoint/OneDrive files", "Azure resources"],
        "usersAffected": "All users",
        "systemsCompromised": ["Entra ID", "Exchange Online", "SharePoint", "Azure subscriptions"]
      },
      "executiveNarrative": "An attacker can use automated password spraying tools to compromise administrator accounts that lack multi-factor authentication. Once inside, they gain complete control of your Microsoft 365 environment, including access to all emails, files, and the ability to create persistent backdoor access. This is the most common path to full tenant compromise.",
      "remediationPriority": 1,
      "estimatedRemediationTime": "4 hours",
      "references": [
        "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-mfa-howitworks",
        "https://attack.mitre.org/techniques/T1110/003/"
      ]
    },
    {
      "id": "AC-002",
      "name": "OAuth App Consent Phishing",
      "description": "Malicious OAuth app steals data via user consent grant",
      "severity": "High",
      "tactics": ["Initial Access", "Collection", "Exfiltration"],
      "mitreTechniques": ["T1528", "T1550.001", "T1114.002"],
      "killChainPhases": {
        "initialAccess": "Phishing email with OAuth consent link",
        "execution": "User grants permissions to malicious app",
        "collection": "App reads emails, calendar, files via Graph API",
        "exfiltration": "Data continuously synced to attacker infrastructure",
        "impact": "Silent, persistent data theft without credential compromise"
      },
      "enablingConditions": [
        {
          "controlId": "2.1.2",
          "condition": "UserConsentDisabled != Compliant",
          "weight": 50
        },
        {
          "controlId": "2.1.3",
          "condition": "AdminConsentWorkflow != Compliant",
          "weight": 25
        },
        {
          "controlId": "2.1.4",
          "condition": "UserConsentBlocked != Compliant",
          "weight": 25
        }
      ],
      "blastRadius": {
        "dataAtRisk": ["Email content", "Calendar data", "Contacts", "OneDrive files"],
        "usersAffected": "Users who consent to malicious app",
        "systemsCompromised": ["User mailbox", "OneDrive", "SharePoint sites with user access"]
      },
      "executiveNarrative": "When users can consent to third-party applications, attackers can trick them into granting access to malicious apps disguised as legitimate services. These apps then silently exfiltrate email, files, and calendar data without triggering traditional security alerts. The attack persists until the app is discovered and revoked.",
      "remediationPriority": 2,
      "estimatedRemediationTime": "2 hours",
      "references": [
        "https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/configure-user-consent",
        "https://attack.mitre.org/techniques/T1528/"
      ]
    },
    {
      "id": "AC-003",
      "name": "Business Email Compromise (BEC)",
      "description": "Account compromise leads to financial fraud via email impersonation",
      "severity": "High",
      "tactics": ["Initial Access", "Collection", "Impact"],
      "mitreTechniques": ["T1078", "T1114", "T1566.002", "T1534"],
      "killChainPhases": {
        "initialAccess": "Credential theft via phishing or password spray",
        "persistence": "Create email forwarding rules to external address",
        "collection": "Monitor email for financial transactions",
        "execution": "Send fraudulent payment instructions",
        "impact": "Wire transfer fraud, invoice manipulation"
      },
      "enablingConditions": [
        {
          "controlId": "1.2.2",
          "condition": "AllUserMFAEnabled != Compliant",
          "weight": 35
        },
        {
          "controlId": "6.2.1",
          "condition": "MailboxAuditingEnabled != Compliant",
          "weight": 20
        },
        {
          "controlId": "6.5.3",
          "condition": "DMARCEnforced != Compliant",
          "weight": 25
        },
        {
          "controlId": "5.1.2.1",
          "condition": "HighRiskSignInBlocked != Compliant",
          "weight": 20
        }
      ],
      "blastRadius": {
        "dataAtRisk": ["Email content", "Financial records", "Vendor/customer data"],
        "usersAffected": "Finance, executives, accounts payable staff",
        "systemsCompromised": ["Exchange Online mailboxes"]
      },
      "executiveNarrative": "Business Email Compromise is the most financially damaging cyberattack type, with billions in losses annually. Attackers compromise employee accounts, monitor financial communications, and then impersonate executives or vendors to redirect payments. Without MFA, mailbox auditing, and email authentication, your organization is highly vulnerable to this attack.",
      "remediationPriority": 2,
      "estimatedRemediationTime": "6 hours",
      "references": [
        "https://www.ic3.gov/Media/PDF/AnnualReport/2023_IC3Report.pdf",
        "https://attack.mitre.org/techniques/T1534/"
      ]
    },
    {
      "id": "AC-004",
      "name": "External Data Exfiltration via Sharing",
      "description": "Data theft through overly permissive external sharing",
      "severity": "High",
      "tactics": ["Collection", "Exfiltration"],
      "mitreTechniques": ["T1530", "T1537", "T1567"],
      "killChainPhases": {
        "initialAccess": "Compromised user account or malicious insider",
        "collection": "Identify sensitive data in SharePoint/OneDrive",
        "exfiltration": "Share files/folders externally or sync to personal device",
        "impact": "Intellectual property theft, regulatory violations"
      },
      "enablingConditions": [
        {
          "controlId": "7.2.1",
          "condition": "ExternalSharingRestricted != Compliant",
          "weight": 40
        },
        {
          "controlId": "7.2.3",
          "condition": "GuestAccessLimited != Compliant",
          "weight": 30
        },
        {
          "controlId": "7.2.2",
          "condition": "SharingDomainRestricted != Compliant",
          "weight": 30
        }
      ],
      "blastRadius": {
        "dataAtRisk": ["SharePoint documents", "OneDrive files", "Teams files"],
        "usersAffected": "Any user with access to sensitive data",
        "systemsCompromised": ["SharePoint Online", "OneDrive for Business", "Microsoft Teams"]
      },
      "executiveNarrative": "When external sharing is unrestricted, any compromised account or malicious insider can exfiltrate sensitive data by simply sharing it externally. This bypasses DLP controls and can lead to intellectual property theft, competitive disadvantage, and regulatory penalties. Restricting external sharing to approved domains significantly reduces this risk.",
      "remediationPriority": 3,
      "estimatedRemediationTime": "3 hours",
      "references": [
        "https://learn.microsoft.com/en-us/sharepoint/external-sharing-overview",
        "https://attack.mitre.org/techniques/T1537/"
      ]
    },
    {
      "id": "AC-005",
      "name": "Persistent Backdoor via App Registration",
      "description": "Attacker creates app with high privileges for long-term access",
      "severity": "Critical",
      "tactics": ["Persistence", "Privilege Escalation", "Defense Evasion"],
      "mitreTechniques": ["T1098.001", "T1550.001", "T1528"],
      "killChainPhases": {
        "initialAccess": "Admin account compromise (any method)",
        "persistence": "Create new app registration with Mail.Read, Files.Read.All, Directory.ReadWrite.All",
        "privilegeEscalation": "Grant admin consent to app permissions",
        "defenseEvasion": "App appears legitimate, no user sign-in logs",
        "impact": "Persistent access surviving password resets and MFA enrollment"
      },
      "enablingConditions": [
        {
          "controlId": "2.1.2",
          "condition": "UserConsentDisabled != Compliant",
          "weight": 30
        },
        {
          "controlId": "1.2.1",
          "condition": "AdminMFAEnabled != Compliant",
          "weight": 40
        },
        {
          "controlId": "5.1.5.1",
          "condition": "PIMEnabled != Compliant",
          "weight": 30
        }
      ],
      "blastRadius": {
        "dataAtRisk": ["All data accessible via Graph API permissions granted"],
        "usersAffected": "All users (if directory permissions granted)",
        "systemsCompromised": ["Entra ID", "Any service accessible via Graph API"]
      },
      "executiveNarrative": "Once an attacker compromises an admin account, they can create an application registration with powerful permissions and admin consent. This app becomes a persistent backdoor that survives password resets, MFA enrollment, and even admin account deletion. Detection requires regular app permission audits, which many organizations don't perform.",
      "remediationPriority": 1,
      "estimatedRemediationTime": "8 hours",
      "references": [
        "https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/manage-application-permissions",
        "https://attack.mitre.org/techniques/T1098/001/"
      ]
    },
    {
      "id": "AC-006",
      "name": "Email Spoofing and Impersonation",
      "description": "Domain spoofing enables phishing targeting employees and partners",
      "severity": "High",
      "tactics": ["Initial Access", "Defense Evasion"],
      "mitreTechniques": ["T1566.001", "T1566.002", "T1534"],
      "killChainPhases": {
        "reconnaissance": "Identify organization domains and key personnel",
        "weaponization": "Craft phishing emails spoofing organization domain",
        "delivery": "Send spoofed emails to employees, customers, or partners",
        "exploitation": "Recipients trust spoofed sender",
        "impact": "Credential theft, malware delivery, BEC enablement"
      },
      "enablingConditions": [
        {
          "controlId": "6.5.1",
          "condition": "SPFConfigured != Compliant",
          "weight": 30
        },
        {
          "controlId": "6.5.2",
          "condition": "DKIMEnabled != Compliant",
          "weight": 30
        },
        {
          "controlId": "6.5.3",
          "condition": "DMARCEnforced != Compliant",
          "weight": 40
        }
      ],
      "blastRadius": {
        "dataAtRisk": ["Credentials", "Any data disclosed via phishing"],
        "usersAffected": "All email recipients (internal and external)",
        "systemsCompromised": ["Email reputation", "Brand trust"]
      },
      "executiveNarrative": "Without proper email authentication (SPF, DKIM, DMARC), attackers can send emails that appear to come from your domain. These spoofed emails can target your employees, customers, and partners for phishing attacks. Proper DMARC enforcement prevents unauthorized use of your domain and protects your brand reputation.",
      "remediationPriority": 3,
      "estimatedRemediationTime": "4 hours",
      "references": [
        "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-about",
        "https://attack.mitre.org/techniques/T1566/"
      ]
    }
  ],
  "severityDefinitions": {
    "Critical": {
      "description": "Full tenant compromise or mass data breach potential",
      "scoreMultiplier": 1.0,
      "slaHours": 24
    },
    "High": {
      "description": "Significant data exposure or financial impact",
      "scoreMultiplier": 0.75,
      "slaHours": 72
    },
    "Medium": {
      "description": "Limited scope exposure or compliance violation",
      "scoreMultiplier": 0.5,
      "slaHours": 168
    },
    "Low": {
      "description": "Best practice deviation with minimal direct risk",
      "scoreMultiplier": 0.25,
      "slaHours": 720
    }
  },
  "tacticsMapping": {
    "Initial Access": "TA0001",
    "Execution": "TA0002",
    "Persistence": "TA0003",
    "Privilege Escalation": "TA0004",
    "Defense Evasion": "TA0005",
    "Credential Access": "TA0006",
    "Discovery": "TA0007",
    "Lateral Movement": "TA0008",
    "Collection": "TA0009",
    "Exfiltration": "TA0010",
    "Impact": "TA0040"
  }
}
