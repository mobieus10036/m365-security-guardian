{
  "benchmarkInfo": {
    "name": "CIS Microsoft 365 Foundations Benchmark",
    "version": "3.1.0",
    "releaseDate": "2024-05-15",
    "url": "https://www.cisecurity.org/benchmark/microsoft_365"
  },
  "controls": [
    {
      "id": "1.1.1",
      "title": "Ensure Security Defaults is disabled on Azure Active Directory",
      "description": "Security Defaults should be disabled when using Conditional Access policies for more granular control.",
      "level": 1,
      "section": "1. Account/Authentication",
      "assessmentKey": "Conditional Access Policies",
      "checkType": "SecurityDefaultsDisabled",
      "rationale": "Security Defaults provide basic protection but Conditional Access offers more granular, risk-based policies for enterprise environments.",
      "remediation": "Navigate to Azure AD > Properties > Manage Security Defaults > Set to No. Implement equivalent or stronger Conditional Access policies.",
      "mitre": ["T1078"],
      "impact": "Users may need to re-register for MFA if transitioning from Security Defaults.",
      "automated": true
    },
    {
      "id": "1.1.3",
      "title": "Ensure that between two and four global admins are designated",
      "description": "There should be more than one global admin for redundancy, but no more than four to limit the attack surface.",
      "level": 1,
      "section": "1. Account/Authentication",
      "assessmentKey": "Privileged Account Security",
      "checkType": "GlobalAdminCount",
      "rationale": "Having multiple global admins ensures business continuity while limiting the number reduces attack surface.",
      "remediation": "Review global admin assignments. Remove unnecessary global admin roles and assign more specific admin roles where possible.",
      "mitre": ["T1078.004"],
      "impact": "Administrators may lose some privileges if demoted from global admin.",
      "automated": true
    },
    {
      "id": "1.2.1",
      "title": "Ensure multi-factor authentication is enabled for all users in administrative roles",
      "description": "MFA should be required for all administrative accounts.",
      "level": 1,
      "section": "1. Account/Authentication",
      "assessmentKey": "MFA Enforcement",
      "checkType": "AdminMFAEnabled",
      "rationale": "Administrative accounts are high-value targets. MFA significantly reduces the risk of account compromise.",
      "remediation": "Create a Conditional Access policy requiring MFA for all users with administrative roles.",
      "mitre": ["T1078", "T1110"],
      "impact": "Administrators will need to use MFA for every sign-in.",
      "automated": true
    },
    {
      "id": "1.2.2",
      "title": "Ensure multi-factor authentication is enabled for all users",
      "description": "MFA should be required for all users, not just administrators.",
      "level": 1,
      "section": "1. Account/Authentication",
      "assessmentKey": "MFA Enforcement",
      "checkType": "AllUserMFAEnabled",
      "rationale": "Any compromised account can be used as a pivot point for lateral movement.",
      "remediation": "Create a Conditional Access policy requiring MFA for all users accessing cloud apps.",
      "mitre": ["T1078", "T1110", "T1534"],
      "impact": "All users will need to register for and use MFA.",
      "automated": true
    },
    {
      "id": "2.1.2",
      "title": "Ensure third party integrated applications are not allowed",
      "description": "Users should not be able to consent to third-party applications accessing organizational data.",
      "level": 1,
      "section": "2. Application Permissions",
      "assessmentKey": "Application Permissions Audit",
      "checkType": "UserConsentDisabled",
      "rationale": "Unrestricted app consent can lead to data exfiltration through malicious OAuth apps.",
      "remediation": "Set 'Users can consent to apps' to 'No' in Azure AD > Enterprise applications > Consent and permissions.",
      "mitre": ["T1550.001", "T1528"],
      "impact": "Users will need admin approval for new applications.",
      "automated": true
    },
    {
      "id": "2.1.3",
      "title": "Ensure the admin consent workflow is enabled",
      "description": "When user consent is disabled, an admin consent workflow should be available.",
      "level": 1,
      "section": "2. Application Permissions",
      "assessmentKey": "Application Permissions Audit",
      "checkType": "AdminConsentWorkflow",
      "rationale": "Provides a controlled path for users to request access to applications while maintaining security oversight.",
      "remediation": "Enable admin consent workflow in Azure AD > Enterprise applications > Admin consent settings.",
      "mitre": ["T1528"],
      "impact": "Administrators will need to review and approve application requests.",
      "automated": true
    },
    {
      "id": "2.1.4",
      "title": "Ensure user consent to apps accessing company data on their behalf is not allowed",
      "description": "Users should not be able to grant permissions to apps to access organizational data.",
      "level": 2,
      "section": "2. Application Permissions",
      "assessmentKey": "Application Permissions Audit",
      "checkType": "UserConsentBlocked",
      "rationale": "Prevents OAuth phishing attacks and unauthorized data access.",
      "remediation": "Set user consent to 'Do not allow user consent' in Azure AD consent settings.",
      "mitre": ["T1550.001", "T1528"],
      "impact": "All application access requires administrator approval.",
      "automated": true
    },
    {
      "id": "5.1.1.1",
      "title": "Ensure legacy authentication is blocked",
      "description": "Legacy authentication protocols that don't support MFA should be blocked.",
      "level": 1,
      "section": "5. Conditional Access",
      "assessmentKey": "Legacy Authentication Blocking",
      "checkType": "LegacyAuthBlocked",
      "rationale": "Legacy protocols like POP, IMAP, and SMTP cannot enforce MFA, making them targets for password spray attacks.",
      "remediation": "Create a Conditional Access policy to block legacy authentication for all users and all apps.",
      "mitre": ["T1110.003", "T1078"],
      "impact": "Applications using legacy protocols will stop working. Test before enabling.",
      "automated": true
    },
    {
      "id": "5.1.2.1",
      "title": "Ensure a Conditional Access policy exists to block high-risk sign-ins",
      "description": "Sign-ins detected as high risk should be blocked.",
      "level": 1,
      "section": "5. Conditional Access",
      "assessmentKey": "Conditional Access Policies",
      "checkType": "HighRiskSignInBlocked",
      "rationale": "Azure AD Identity Protection detects suspicious sign-in patterns. High-risk sign-ins should be blocked.",
      "remediation": "Create a Conditional Access policy that blocks access when sign-in risk is high.",
      "mitre": ["T1078", "T1110"],
      "impact": "Legitimate users may be blocked if signing in from unusual locations or devices.",
      "automated": true
    },
    {
      "id": "5.1.2.2",
      "title": "Ensure a Conditional Access policy exists to block high-risk users",
      "description": "Users flagged as high risk should be blocked or required to change password.",
      "level": 1,
      "section": "5. Conditional Access",
      "assessmentKey": "Conditional Access Policies",
      "checkType": "HighRiskUserBlocked",
      "rationale": "Users whose credentials are likely compromised should be blocked until remediated.",
      "remediation": "Create a Conditional Access policy that blocks access or requires password change for high-risk users.",
      "mitre": ["T1078"],
      "impact": "Affected users will need to reset passwords and re-register MFA.",
      "automated": true
    },
    {
      "id": "5.1.2.3",
      "title": "Ensure a Conditional Access policy exists requiring MFA for administrators",
      "description": "Administrative roles should always require MFA.",
      "level": 1,
      "section": "5. Conditional Access",
      "assessmentKey": "Conditional Access Policies",
      "checkType": "AdminMFARequired",
      "rationale": "Administrative accounts are primary targets and should always require strong authentication.",
      "remediation": "Create a Conditional Access policy requiring MFA for directory roles.",
      "mitre": ["T1078.004"],
      "impact": "Administrators must complete MFA for every sign-in.",
      "automated": true
    },
    {
      "id": "5.1.2.4",
      "title": "Ensure a Conditional Access policy exists requiring MFA for all users",
      "description": "All users should be required to perform MFA.",
      "level": 1,
      "section": "5. Conditional Access",
      "assessmentKey": "Conditional Access Policies",
      "checkType": "AllUserMFARequired",
      "rationale": "Universal MFA dramatically reduces the risk of account compromise.",
      "remediation": "Create a Conditional Access policy requiring MFA for all users accessing all cloud apps.",
      "mitre": ["T1078", "T1110"],
      "impact": "All users must register for and complete MFA.",
      "automated": true
    },
    {
      "id": "5.1.2.5",
      "title": "Ensure a Conditional Access policy exists requiring MFA for Azure management",
      "description": "Access to Azure management resources should require MFA.",
      "level": 1,
      "section": "5. Conditional Access",
      "assessmentKey": "Conditional Access Policies",
      "checkType": "AzureManagementMFA",
      "rationale": "Azure management APIs control infrastructure and should require additional verification.",
      "remediation": "Create a Conditional Access policy requiring MFA for Microsoft Azure Management app.",
      "mitre": ["T1078.004"],
      "impact": "Users accessing Azure portal or APIs must complete MFA.",
      "automated": true
    },
    {
      "id": "5.1.5.1",
      "title": "Ensure Privileged Identity Management is used to manage roles",
      "description": "PIM should be used for just-in-time privileged access.",
      "level": 1,
      "section": "5. Conditional Access",
      "assessmentKey": "Privileged Identity Management (PIM)",
      "checkType": "PIMEnabled",
      "rationale": "Just-in-time access reduces standing privileges and provides audit trails for role activation.",
      "remediation": "Enable PIM and convert permanent role assignments to eligible assignments.",
      "mitre": ["T1078.004"],
      "impact": "Requires Azure AD P2 licensing. Administrators must activate roles when needed.",
      "automated": true
    },
    {
      "id": "5.1.6.1",
      "title": "Ensure Phishing-resistant MFA strength is required for Administrators",
      "description": "Administrators should use phishing-resistant authentication methods.",
      "level": 1,
      "section": "5. Conditional Access",
      "assessmentKey": "Conditional Access Policies",
      "checkType": "PhishingResistantMFA",
      "rationale": "Phishing-resistant methods like FIDO2 and Windows Hello prevent AitM attacks.",
      "remediation": "Create an Authentication Strength requiring FIDO2 or Windows Hello for Business for admin roles.",
      "mitre": ["T1557", "T1539"],
      "impact": "Administrators need compatible devices and must register phishing-resistant credentials.",
      "automated": true
    },
    {
      "id": "6.1.1",
      "title": "Ensure Exchange Online Spam Filter is enabled",
      "description": "Anti-spam filtering should be enabled for all mailboxes.",
      "level": 1,
      "section": "6. Exchange Online",
      "assessmentKey": "Email Security Configuration",
      "checkType": "SpamFilterEnabled",
      "rationale": "Spam filtering blocks phishing attempts and malware delivery.",
      "remediation": "Verify spam filter policies are enabled in Exchange Online Protection.",
      "mitre": ["T1566.001", "T1566.002"],
      "impact": "Legitimate emails may occasionally be filtered.",
      "automated": true
    },
    {
      "id": "6.1.2",
      "title": "Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled",
      "description": "Safe Attachments should scan files in SharePoint, OneDrive, and Teams.",
      "level": 2,
      "section": "6. Exchange Online",
      "assessmentKey": "Email Security Configuration",
      "checkType": "SafeAttachmentsEnabled",
      "rationale": "Extends malware protection to files uploaded to collaboration platforms.",
      "remediation": "Enable Safe Attachments for SharePoint, OneDrive, and Teams in Microsoft 365 Defender.",
      "mitre": ["T1566.001"],
      "impact": "Malicious files are quarantined, potentially causing brief delays.",
      "automated": true
    },
    {
      "id": "6.1.3",
      "title": "Ensure Safe Links for Office Applications is Enabled",
      "description": "Safe Links should scan URLs in Office documents.",
      "level": 1,
      "section": "6. Exchange Online",
      "assessmentKey": "Email Security Configuration",
      "checkType": "SafeLinksEnabled",
      "rationale": "Protects users from malicious links embedded in documents.",
      "remediation": "Enable Safe Links policies for Office applications in Microsoft 365 Defender.",
      "mitre": ["T1566.002"],
      "impact": "URLs are scanned at click time, adding minimal delay.",
      "automated": true
    },
    {
      "id": "6.3.1",
      "title": "Ensure mailbox auditing for E5 users is Enabled",
      "description": "Advanced mailbox auditing should be enabled for all mailboxes.",
      "level": 1,
      "section": "6. Exchange Online",
      "assessmentKey": "Mailbox Auditing",
      "checkType": "MailboxAuditingEnabled",
      "rationale": "Mailbox auditing provides forensic visibility into mailbox access and changes.",
      "remediation": "Enable mailbox auditing organization-wide using Set-OrganizationConfig.",
      "mitre": ["T1114", "T1114.002"],
      "impact": "Increased storage for audit logs.",
      "automated": true
    },
    {
      "id": "6.5.1",
      "title": "Ensure SPF records are published for all Exchange Online domains",
      "description": "SPF records should be configured for all domains to prevent spoofing.",
      "level": 1,
      "section": "6. Exchange Online",
      "assessmentKey": "Email Authentication (SPF/DKIM/DMARC)",
      "checkType": "SPFConfigured",
      "rationale": "SPF helps receiving servers verify that mail came from authorized servers.",
      "remediation": "Add SPF TXT records to DNS for all domains including 'include:spf.protection.outlook.com'.",
      "mitre": ["T1566.001", "T1534"],
      "impact": "None when correctly configured.",
      "automated": true
    },
    {
      "id": "6.5.2",
      "title": "Ensure DKIM is enabled for all Exchange Online domains",
      "description": "DKIM signing should be enabled for outbound mail.",
      "level": 1,
      "section": "6. Exchange Online",
      "assessmentKey": "Email Authentication (SPF/DKIM/DMARC)",
      "checkType": "DKIMEnabled",
      "rationale": "DKIM provides cryptographic verification that mail hasn't been modified in transit.",
      "remediation": "Enable DKIM for each domain in Exchange Online and publish CNAME records.",
      "mitre": ["T1566.001"],
      "impact": "Requires DNS changes for DKIM CNAME records.",
      "automated": true
    },
    {
      "id": "6.5.3",
      "title": "Ensure DMARC Records for all Exchange Online domains are published",
      "description": "DMARC records should be published with enforcement policies.",
      "level": 1,
      "section": "6. Exchange Online",
      "assessmentKey": "Email Authentication (SPF/DKIM/DMARC)",
      "checkType": "DMARCEnforced",
      "rationale": "DMARC tells receivers what to do when SPF/DKIM fail, enabling enforcement.",
      "remediation": "Publish DMARC records with 'p=quarantine' or 'p=reject' after monitoring with 'p=none'.",
      "mitre": ["T1566.001", "T1534"],
      "impact": "Misconfigured DMARC can cause legitimate mail to be rejected.",
      "automated": true
    },
    {
      "id": "7.2.1",
      "title": "Ensure SharePoint Online external sharing is managed through domain whitelist/blacklists",
      "description": "External sharing should be restricted to approved domains.",
      "level": 2,
      "section": "7. SharePoint and OneDrive",
      "assessmentKey": "External Sharing Configuration",
      "checkType": "SharingDomainRestricted",
      "rationale": "Prevents data sharing with unauthorized external organizations.",
      "remediation": "Configure allowed/blocked domains in SharePoint admin center sharing settings.",
      "mitre": ["T1537"],
      "impact": "Users cannot share with partners not on the allowed list.",
      "automated": true
    },
    {
      "id": "7.2.3",
      "title": "Ensure external content sharing is restricted",
      "description": "Sharing with 'Anyone' links should be disabled or restricted.",
      "level": 1,
      "section": "7. SharePoint and OneDrive",
      "assessmentKey": "External Sharing Configuration",
      "checkType": "AnonymousSharingDisabled",
      "rationale": "Anyone links create publicly accessible content without authentication.",
      "remediation": "Disable 'Anyone' links or restrict to specific users/groups.",
      "mitre": ["T1530", "T1537"],
      "impact": "Users must share with specific accounts rather than anonymous links.",
      "automated": true
    }
  ]
}
