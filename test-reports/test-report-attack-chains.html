<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline'; script-src https://cdn.jsdelivr.net 'unsafe-inline'; img-src data:; font-src 'none';">
    <title>M365 Security Guardian Report - Contoso.onmicrosoft.com</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" integrity="sha384-e6nUZLBkQ86NJ6TVVKAeSaK8jWa3NhkYWZFomE39AvDbQWeie9PlQqM3pmYW5d1g" crossorigin="anonymous"></script>
    <style>
        :root {
            --primary-color: #0078d4;
            --primary-dark: #005a9e;
            --success-color: #107c10;
            --danger-color: #d13438;
            --warning-color: #ff8c00;
            --info-color: #0078d4;
            --gray-50: #fafafa;
            --gray-100: #f5f5f5;
            --gray-200: #e5e5e5;
            --gray-300: #d4d4d4;
            --gray-700: #424242;
            --gray-900: #1a1a1a;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
            --radius-sm: 4px;
            --radius-md: 8px;
            --radius-lg: 12px;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: var(--gray-100);
            color: var(--gray-900);
            line-height: 1.6;
            padding: 20px;
        }
        
        .container { 
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: var(--shadow-lg);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }
        
        .header { 
            background: linear-gradient(135deg, #0078d4 0%, #005a9e 50%, #004578 100%);
            color: white;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }
        
        .header-content { position: relative; z-index: 1; }
        
        .header h1 { 
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }
        
        .header-meta { 
            display: flex;
            gap: 30px;
            margin-top: 15px;
            font-size: 14px;
            opacity: 0.95;
        }
        
        .header-meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .header-meta-label { 
            font-weight: 600;
            opacity: 0.8;
        }
        
        .executive-summary {
            padding: 40px;
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .summary-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 25px;
            color: var(--gray-900);
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: white;
            padding: 24px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .metric-card-header {
            font-size: 13px;
            font-weight: 600;
            color: var(--gray-700);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }
        
        .metric-card-value {
            font-size: 42px;
            font-weight: 700;
            line-height: 1;
        }
        
        .metric-card.total .metric-card-value { color: var(--gray-900); }
        .metric-card.pass .metric-card-value { color: var(--success-color); }
        .metric-card.fail .metric-card-value { color: var(--danger-color); }
        .metric-card.warn .metric-card-value { color: var(--warning-color); }
        .metric-card.info .metric-card-value { color: var(--info-color); }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .chart-container {
            background: white;
            padding: 24px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
        }
        
        .chart-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--gray-900);
        }
        
        .chart-wrapper {
            position: relative;
            height: 250px;
        }
        
        .controls {
            padding: 30px 40px;
            background: white;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 16px;
            border: 2px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: 14px;
            transition: border-color 0.2s;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-700);
        }
        
        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 8px 16px;
            border: 2px solid var(--gray-300);
            background: white;
            border-radius: var(--radius-md);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .filter-btn.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }
        
        .results-section {
            padding: 40px;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .results-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--gray-900);
        }
        
        .results-count {
            font-size: 14px;
            color: var(--gray-700);
            background: var(--gray-100);
            padding: 8px 16px;
            border-radius: var(--radius-md);
        }
        
        .findings-grid {
            display: grid;
            gap: 20px;
        }
        
        .finding-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-md);
            padding: 24px;
            box-shadow: var(--shadow-sm);
            transition: all 0.2s;
        }
        
        .finding-card:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--gray-300);
        }
        
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
            gap: 20px;
        }
        
        .finding-title-group {
            flex: 1;
        }
        
        .finding-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 8px;
        }
        
        .finding-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: var(--radius-sm);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .badge-status-pass { background: #dff6dd; color: #107c10; }
        .badge-status-fail { background: #fde7e9; color: #d13438; }
        .badge-status-warning { background: #fff4ce; color: #8a4600; }
        .badge-status-info { background: #e1f5fe; color: #0078d4; }
        
        .badge-severity-critical { background: #d13438; color: white; }
        .badge-severity-high { background: #ff8c00; color: white; }
        .badge-severity-medium { background: #ffd700; color: #333; }
        .badge-severity-low { background: #90ee90; color: #333; }
        .badge-severity-info { background: #e1f5fe; color: #0078d4; }
        
        .badge-category {
            background: var(--primary-color);
            color: white;
        }
        
        .finding-body {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--gray-200);
        }
        
        .finding-section {
            margin-bottom: 16px;
        }
        
        .finding-section:last-child {
            margin-bottom: 0;
        }
        
        .finding-label {
            font-size: 13px;
            font-weight: 600;
            color: var(--gray-700);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        
        .finding-content {
            font-size: 14px;
            color: var(--gray-900);
            line-height: 1.6;
        }
        
        .finding-content ul {
            margin-left: 20px;
            margin-top: 8px;
        }
        
        .finding-content li {
            margin: 4px 0;
        }
        
        .finding-content code {
            background: var(--gray-100);
            padding: 2px 6px;
            border-radius: var(--radius-sm);
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            color: var(--danger-color);
        }

        .mfa-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin: 8px 0 12px;
        }

        .mfa-stat {
            background: var(--gray-100);
            border: 1px solid var(--gray-200);
            padding: 10px 12px;
            border-radius: var(--radius-sm);
        }

        .mfa-label {
            display: block;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.4px;
            color: var(--gray-700);
            margin-bottom: 4px;
        }

        .mfa-value {
            font-size: 16px;
            font-weight: 700;
            color: var(--gray-900);
        }

        .mfa-note {
            font-size: 12px;
            color: var(--gray-700);
            margin-top: 6px;
        }
        
        .doc-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: color 0.2s;
        }
        
        .doc-link:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray-700);
        }
        
        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }
        
        .empty-state-text {
            font-size: 18px;
            font-weight: 600;
        }
        
        @media print {
            body { padding: 0; background: white; }
            .container { box-shadow: none; }
            .controls { display: none; }
            .finding-card { page-break-inside: avoid; }
            .chart-wrapper { height: 200px; }
        }
        
        @media (max-width: 768px) {
            .header { padding: 24px; }
            .header h1 { font-size: 24px; }
            .header-meta { flex-direction: column; gap: 10px; }
            .executive-summary { padding: 24px; }
            .metrics-grid { grid-template-columns: repeat(2, 1fr); }
            .charts-grid { grid-template-columns: 1fr; }
            .results-section { padding: 24px; }
            .controls { padding: 20px; }
            .score-main-display { flex-direction: column; text-align: center; }
            .score-actions-grid { grid-template-columns: 1fr; }
        }
        
        /* Security Score Dashboard Styles */
        .security-score-dashboard {
            padding: 40px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .score-main-display {
            display: flex;
            align-items: center;
            gap: 40px;
            margin-bottom: 30px;
        }
        
        .score-circle {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            flex-shrink: 0;
        }
        
        .score-circle.grade-a { background: linear-gradient(135deg, #107c10, #0b5c0b); color: white; }
        .score-circle.grade-b { background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; }
        .score-circle.grade-c { background: linear-gradient(135deg, #f39c12, #d68910); color: white; }
        .score-circle.grade-d { background: linear-gradient(135deg, #e67e22, #d35400); color: white; }
        .score-circle.grade-f { background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; }
        
        .score-value {
            font-size: 36px;
            font-weight: 700;
            line-height: 1;
        }
        
        .score-grade {
            font-size: 16px;
            font-weight: 600;
            margin-top: 8px;
            opacity: 0.9;
        }
        
        .score-details {
            flex: 1;
        }
        
        .score-description {
            font-size: 20px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 16px;
        }
        
        .score-potential {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .potential-label {
            font-weight: 600;
            color: var(--gray-700);
        }
        
        .potential-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .potential-gain {
            background: #e8f5e9;
            color: #107c10;
            padding: 4px 12px;
            border-radius: var(--radius-sm);
            font-size: 13px;
            font-weight: 600;
        }
        
        .score-categories {
            margin-bottom: 30px;
        }
        
        .score-categories h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--gray-900);
        }
        
        .score-category {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 12px;
        }
        
        .score-category-name {
            width: 180px;
            font-size: 14px;
            font-weight: 500;
            color: var(--gray-700);
        }
        
        .score-category-bar {
            flex: 1;
            height: 24px;
            background: var(--gray-200);
            border-radius: var(--radius-md);
            overflow: hidden;
        }
        
        .score-category-fill {
            height: 100%;
            border-radius: var(--radius-md);
            transition: width 0.5s ease;
        }
        
        .score-category-fill.grade-a { background: linear-gradient(90deg, #107c10, #2ecc71); }
        .score-category-fill.grade-b { background: linear-gradient(90deg, #27ae60, #58d68d); }
        .score-category-fill.grade-c { background: linear-gradient(90deg, #f39c12, #f7dc6f); }
        .score-category-fill.grade-d { background: linear-gradient(90deg, #e67e22, #f5b041); }
        .score-category-fill.grade-f { background: linear-gradient(90deg, #e74c3c, #ec7063); }
        
        .score-category-value {
            width: 60px;
            text-align: right;
            font-weight: 600;
            color: var(--gray-900);
        }
        
        .score-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }
        
        .priorities-section, .quickwins-section {
            background: white;
            padding: 24px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
        }
        
        .priorities-section h4, .quickwins-section h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--gray-900);
        }
        
        .priorities-section ul, .quickwins-section ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        .priorities-section li, .quickwins-section li {
            padding: 10px 0;
            border-bottom: 1px solid var(--gray-100);
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .priorities-section li:last-child, .quickwins-section li:last-child {
            border-bottom: none;
        }
        
        .priority-severity {
            display: inline-block;
            padding: 2px 8px;
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .priority-severity.critical { background: #d13438; color: white; }
        .priority-severity.high { background: #ff8c00; color: white; }
        .priority-severity.medium { background: #ffd700; color: #333; }
        .priority-severity.low { background: #90ee90; color: #333; }
        
        .priority-gain {
            margin-left: auto;
            background: #e8f5e9;
            color: #107c10;
            padding: 2px 8px;
            border-radius: var(--radius-sm);
            font-size: 12px;
            font-weight: 600;
        }
        
        /* Baseline Comparison Styles */
        .baseline-comparison-section {
            padding: 30px 40px;
            background: linear-gradient(135deg, #f0f7ff 0%, #e8f4f8 100%);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .baseline-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
        }
        
        .baseline-title {
            font-size: 22px;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 8px;
        }
        
        .baseline-meta {
            font-size: 14px;
            color: var(--gray-700);
        }
        
        .baseline-trend {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            border-radius: var(--radius-md);
            font-size: 18px;
            font-weight: 700;
        }
        
        .baseline-trend.improving {
            background: #dff6dd;
            color: #107c10;
        }
        
        .baseline-trend.declining {
            background: #fde7e9;
            color: #d13438;
        }
        
        .baseline-trend.stable {
            background: #fff4ce;
            color: #8a4600;
        }
        
        .baseline-trend-icon {
            font-size: 24px;
        }
        
        .baseline-score-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .baseline-score-card {
            background: white;
            padding: 20px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            text-align: center;
        }
        
        .baseline-score-label {
            font-size: 13px;
            color: var(--gray-700);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        
        .baseline-score-value {
            font-size: 32px;
            font-weight: 700;
        }
        
        .baseline-score-delta {
            font-size: 14px;
            font-weight: 600;
            margin-top: 4px;
        }
        
        .baseline-score-delta.positive { color: #107c10; }
        .baseline-score-delta.negative { color: #d13438; }
        .baseline-score-delta.neutral { color: var(--gray-700); }
        
        .baseline-changes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .baseline-change-card {
            background: white;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
        }
        
        .baseline-change-header {
            padding: 16px 20px;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .baseline-change-header.improvements {
            background: #dff6dd;
            color: #107c10;
        }
        
        .baseline-change-header.regressions {
            background: #fde7e9;
            color: #d13438;
        }
        
        .baseline-change-list {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .baseline-change-item {
            padding: 12px 20px;
            border-bottom: 1px solid var(--gray-100);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .baseline-change-item:last-child {
            border-bottom: none;
        }
        
        .baseline-change-name {
            font-weight: 500;
        }
        
        .baseline-change-status {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 13px;
        }
        
        .baseline-empty {
            padding: 20px;
            text-align: center;
            color: var(--gray-700);
            font-style: italic;
        }

        /* Tenant Changes Section (within Baseline Comparison) */
        .tenant-changes-section {
            margin-top: 28px;
            padding-top: 24px;
            border-top: 2px solid var(--gray-200);
        }

        .tenant-changes-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 16px;
        }

        .baseline-change-header.tenant-mfa-header {
            background: #e8f0fe;
            color: #1a56db;
        }

        .baseline-change-header.tenant-priv-header {
            background: #fff4ce;
            color: #8a4600;
        }

        .tenant-change-table-wrap {
            max-height: 300px;
            overflow-y: auto;
        }

        .tenant-change-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .tenant-change-table thead th {
            text-align: left;
            padding: 10px 16px;
            background: var(--gray-50);
            color: var(--gray-700);
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--gray-200);
        }

        .tenant-change-table tbody td {
            padding: 10px 16px;
            border-bottom: 1px solid var(--gray-100);
            vertical-align: middle;
        }

        .tenant-change-table tbody tr:last-child td {
            border-bottom: none;
        }

        .tenant-change-table small {
            color: var(--gray-600);
        }

        .tenant-change-gained {
            color: #107c10;
            font-weight: 600;
        }

        .tenant-change-lost {
            color: #d13438;
            font-weight: 600;
        }

        /* Attack Chains Section */
        .attack-chains-section {
            padding: 30px 40px;
            background: linear-gradient(135deg, #fef2f2 0%, #fff5f5 100%);
            border-bottom: 1px solid var(--gray-200);
        }

        .attack-chains-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .attack-chains-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .attack-risk-level {
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .attack-risk-level.risk-critical {
            background: linear-gradient(135deg, #d13438, #a4262c);
            color: white;
            box-shadow: 0 2px 8px rgba(209, 52, 56, 0.3);
        }

        .attack-risk-level.risk-high {
            background: linear-gradient(135deg, #ff8c00, #d97706);
            color: white;
            box-shadow: 0 2px 8px rgba(255, 140, 0, 0.3);
        }

        .attack-risk-level.risk-elevated {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .attack-risk-level.risk-low {
            background: linear-gradient(135deg, #107c10, #0e6b0e);
            color: white;
        }

        .attack-chains-summary {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
        }

        .chains-stat {
            text-align: center;
            padding: 8px 16px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .chains-stat .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--gray-900);
        }

        .chains-stat .stat-label {
            font-size: 12px;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .attack-chains-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 28px;
        }

        .attack-chain-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            border-left: 5px solid var(--gray-400);
            transition: box-shadow 0.2s ease, transform 0.2s ease;
        }

        .attack-chain-card:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }

        .attack-chain-card.severity-critical {
            border-left-color: #d13438;
        }

        .attack-chain-card.severity-high {
            border-left-color: #ff8c00;
        }

        .attack-chain-card.severity-medium {
            border-left-color: #ffc107;
        }

        .attack-chain-header {
            padding: 16px 20px;
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-100);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .attack-chain-severity {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .attack-chain-severity.severity-critical {
            background: #fde7e7;
            color: #d13438;
        }

        .attack-chain-severity.severity-high {
            background: #fff4e5;
            color: #d97706;
        }

        .attack-chain-severity.severity-medium {
            background: #fff8e1;
            color: #8a6d00;
        }

        .attack-chain-id {
            font-size: 12px;
            color: var(--gray-600);
            font-family: monospace;
        }

        .attack-chain-name {
            padding: 16px 20px 12px;
            font-size: 16px;
            font-weight: 600;
            color: var(--gray-900);
        }

        .attack-chain-tactics {
            padding: 0 20px 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .attack-tactic {
            padding: 3px 8px;
            background: #e8f0fe;
            color: #1a56db;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .attack-chain-mitre {
            padding: 0 20px 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .mitre-badge {
            padding: 3px 8px;
            background: var(--gray-100);
            color: var(--gray-700);
            border-radius: 4px;
            font-size: 10px;
            font-family: monospace;
            font-weight: 500;
        }

        .attack-chain-enablement {
            padding: 12px 20px;
            background: var(--gray-50);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
        }

        .enablement-label {
            font-size: 12px;
            color: var(--gray-600);
        }

        .enablement-value {
            font-size: 14px;
            font-weight: 600;
            color: #d13438;
        }

        .fix-time {
            font-size: 12px;
            color: var(--gray-600);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .attack-chain-narrative {
            padding: 16px 20px;
            font-size: 13px;
            color: var(--gray-700);
            line-height: 1.5;
            border-top: 1px solid var(--gray-100);
        }

        .kill-chain-phases {
            padding: 16px 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            background: var(--gray-50);
            border-top: 1px solid var(--gray-100);
        }

        .kill-chain-phase {
            padding: 6px 12px;
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 6px;
            font-size: 12px;
            color: var(--gray-700);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .kill-chain-phase::after {
            content: "‚Üí";
            color: var(--gray-400);
            margin-left: 8px;
        }

        .kill-chain-phase:last-child::after {
            content: "";
            margin-left: 0;
        }

        .blast-radius {
            padding: 12px 20px;
            background: #fef2f2;
            border-top: 1px solid #fecaca;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .blast-label {
            font-size: 12px;
            font-weight: 600;
            color: #991b1b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .blast-data {
            font-size: 13px;
            color: #7f1d1d;
        }

        .blast-users {
            font-weight: 600;
        }

        .remediation-priorities {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            padding: 20px;
            margin-bottom: 20px;
        }

        .remediation-priorities h4 {
            font-size: 16px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .remediation-priorities ol {
            margin: 0;
            padding-left: 20px;
        }

        .remediation-priorities li {
            padding: 8px 0;
            font-size: 14px;
            color: var(--gray-700);
            border-bottom: 1px solid var(--gray-100);
        }

        .remediation-priorities li:last-child {
            border-bottom: none;
        }

        .remediation-priorities li strong {
            color: var(--gray-900);
        }

        .mitre-summary {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            padding: 20px;
        }

        .mitre-summary h4 {
            font-size: 16px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 16px;
        }

        .tactic-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tactic-badge {
            padding: 8px 14px;
            background: linear-gradient(135deg, #1a56db 0%, #1e40af 100%);
            color: white;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .tactic-badge .count {
            font-size: 16px;
            font-weight: 700;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>M365 Security Guardian Report</h1>
                <div class="header-meta">
                    <div class="header-meta-item">
                        <span class="header-meta-label">Tenant:</span>
                        <span>Contoso.onmicrosoft.com</span>
                    </div>
                    <div class="header-meta-item">
                        <span class="header-meta-label">Assessment Date:</span>
                        <span>2026-02-14 12:47:34</span>
                    </div>
                    <div class="header-meta-item">
                        <span class="header-meta-label">Compliance Score:</span>
                        <span>0%</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="executive-summary">
            <h2 class="summary-title">Executive Summary</h2>
            
            <div class="metrics-grid">
                <div class="metric-card total">
                    <div class="metric-card-header">Total Checks</div>
                    <div class="metric-card-value">8</div>
                </div>
                <div class="metric-card pass">
                    <div class="metric-card-header">Passed</div>
                    <div class="metric-card-value">0</div>
                </div>
                <div class="metric-card fail">
                    <div class="metric-card-header">Failed</div>
                    <div class="metric-card-value">5</div>
                </div>
                <div class="metric-card warn">
                    <div class="metric-card-header">Warnings</div>
                    <div class="metric-card-value">3</div>
                </div>
                <div class="metric-card info">
                    <div class="metric-card-header">Informational</div>
                    <div class="metric-card-value">0</div>
                </div>
            </div>
            
            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title">Status Distribution</div>
                    <div class="chart-wrapper">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-title">Findings by Severity</div>
                    <div class="chart-wrapper">
                        <canvas id="severityChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
            <div class="security-score-dashboard">
        <h2 class="summary-title">üõ°Ô∏è Tenant Security Score</h2>
        <div class="score-main-display">
            <div class="score-circle grade-f">
                <div class="score-value">21%</div>
                <div class="score-grade">Grade: F</div>
            </div>
            <div class="score-details">
                <div class="score-description">Critical - Immediate action required to secure tenant</div>
                <div class="score-potential">
                    <span class="potential-label">Potential Score:</span>
                    <span class="potential-value">53%</span>
                    <span class="potential-gain">(+31.8 pts available)</span>
                </div>
            </div>
        </div>
        <div class="score-categories">
            <h3>Category Breakdown</h3>
                    <div class="score-category">
            <div class="score-category-name">Email Security</div>
            <div class="score-category-bar">
                <div class="score-category-fill grade-f" style="width: 16.7%"></div>
            </div>
            <div class="score-category-value">16.7%</div>
        </div>        <div class="score-category">
            <div class="score-category-name">Application Security</div>
            <div class="score-category-bar">
                <div class="score-category-fill grade-a" style="width: 100%"></div>
            </div>
            <div class="score-category-value">100%</div>
        </div>        <div class="score-category">
            <div class="score-category-name">Identity &amp; Access</div>
            <div class="score-category-bar">
                <div class="score-category-fill grade-f" style="width: 18.5%"></div>
            </div>
            <div class="score-category-value">18.5%</div>
        </div>        <div class="score-category">
            <div class="score-category-name">Governance</div>
            <div class="score-category-bar">
                <div class="score-category-fill grade-f" style="width: 0%"></div>
            </div>
            <div class="score-category-value">0%</div>
        </div>        <div class="score-category">
            <div class="score-category-name">Conditional Access</div>
            <div class="score-category-bar">
                <div class="score-category-fill grade-f" style="width: 30%"></div>
            </div>
            <div class="score-category-value">30%</div>
        </div>
        </div>
        <div class="score-actions-grid">
            <div class='priorities-section'><h4>üéØ Top Priorities</h4><ul><li><span class='priority-severity critical'>Critical</span> MFA Enforcement <span class='priority-gain'>+12 pts</span></li><li><span class='priority-severity high'>High</span> External Sharing Configuration <span class='priority-gain'>+7.5 pts</span></li><li><span class='priority-severity high'>High</span> Email Authentication (SPF/DKIM/DMARC) <span class='priority-gain'>+6 pts</span></li><li><span class='priority-severity high'>High</span> Legacy Authentication <span class='priority-gain'>+3.8 pts</span></li><li><span class='priority-severity medium'>Medium</span> Application Permissions Audit <span class='priority-gain'>+2.5 pts</span></li></ul></div>
            <div class='quickwins-section'><h4>‚ö° Quick Wins</h4><ul><li>Mailbox Auditing <span class='priority-gain'>+2 pts</span></li></ul></div>
        </div>
    </div>
        
        
        
            <div class='attack-chains-section'>
        <div class='attack-chains-header'>
            <h2 class='attack-chains-title'>‚öîÔ∏è Attack Chain Analysis</h2>
            <div class='attack-risk-level risk-critical'>
                <span class='risk-icon'>üî¥</span>
                <span class='risk-text'>CRITICAL RISK</span>
            </div>
        </div>
        
        <div class='attack-chains-summary'>
            <div class='chains-stat'>
                <span class='stat-value'>6</span>
                <span class='stat-label'>Enabled Chains</span>
            </div>
            <div class='chains-stat'>
                <span class='stat-value'>2</span>
                <span class='stat-label'>Critical</span>
            </div>
            <div class='chains-stat'>
                <span class='stat-value'>4</span>
                <span class='stat-label'>High</span>
            </div>
            <div class='chains-stat'>
                <span class='stat-value'>6</span>
                <span class='stat-label'>Total Analyzed</span>
            </div>
        </div>
        
        <div class='remediation-priorities'><h4>üîß Top Remediation Priorities</h4><ul><li><strong>Control 1.2.1</strong> - Breaks 2 attack chain(s)</li><li><strong>Control 2.1.2</strong> - Breaks 2 attack chain(s)</li><li><strong>Control 6.5.3</strong> - Breaks 2 attack chain(s)</li><li><strong>Control 5.1.5.1</strong> - Breaks 2 attack chain(s)</li><li><strong>Control 5.1.1.1</strong> - Breaks 1 attack chain(s)</li></ul></div>
        
        <div class='attack-chains-grid'>
                    <div class='attack-chain-card severity-critical'>
            <div class='attack-chain-header'>
                <span class='attack-chain-severity'>üî¥ Critical</span>
                <span class='attack-chain-id'>AC-001</span>
            </div>
            <h4 class='attack-chain-name'>Password Spray to Global Admin Takeover</h4>
            <div class='attack-chain-tactics'><span class='attack-tactic'>Initial Access</span> ‚Üí <span class='attack-tactic'>Privilege Escalation</span> ‚Üí <span class='attack-tactic'>Persistence</span></div>
            <div class='attack-chain-mitre'><span class='mitre-badge'>T1110.003</span> <span class='mitre-badge'>T1078.004</span> <span class='mitre-badge'>T1098</span></div>
            <div class='attack-chain-enablement'>
                <span class='enablement-label'>Enablement:</span>
                <span class='enablement-value'>100%</span>
                <span class='fix-time'>Fix Time: 4 hours</span>
            </div>
            <div class='attack-chain-narrative'>An attacker can use automated password spraying tools to compromise administrator accounts that lack multi-factor authentication. Once inside, they gain complete control of your Microsoft 365 environment, including access to all emails, files, and the ability to create persistent backdoor access. This is the most common path to full tenant compromise.</div>
            <div class='kill-chain-phases'><div class='kill-chain-phase'><strong>Initial Access:</strong> Password spray against admin accounts lacking MFA</div><div class='kill-chain-phase'><strong>Execution:</strong> Access Azure/M365 admin portals</div><div class='kill-chain-phase'><strong>Persistence:</strong> Create backdoor admin accounts or app registrations</div><div class='kill-chain-phase'><strong>Privilege Escalation:</strong> Already admin - no escalation needed</div><div class='kill-chain-phase'><strong>Impact:</strong> Full tenant compromise, data exfiltration, ransomware deployment</div></div>
                        <div class='blast-radius'>
                <span class='blast-label'>Blast Radius:</span>
                <span class='blast-data'>All tenant data, Email content, SharePoint/OneDrive files, Azure resources</span>
                <span class='blast-users'>(All users)</span>
            </div>
        </div>        <div class='attack-chain-card severity-critical'>
            <div class='attack-chain-header'>
                <span class='attack-chain-severity'>üî¥ Critical</span>
                <span class='attack-chain-id'>AC-005</span>
            </div>
            <h4 class='attack-chain-name'>Persistent Backdoor via App Registration</h4>
            <div class='attack-chain-tactics'><span class='attack-tactic'>Persistence</span> ‚Üí <span class='attack-tactic'>Privilege Escalation</span> ‚Üí <span class='attack-tactic'>Defense Evasion</span></div>
            <div class='attack-chain-mitre'><span class='mitre-badge'>T1098.001</span> <span class='mitre-badge'>T1550.001</span> <span class='mitre-badge'>T1528</span></div>
            <div class='attack-chain-enablement'>
                <span class='enablement-label'>Enablement:</span>
                <span class='enablement-value'>100%</span>
                <span class='fix-time'>Fix Time: 8 hours</span>
            </div>
            <div class='attack-chain-narrative'>Once an attacker compromises an admin account, they can create an application registration with powerful permissions and admin consent. This app becomes a persistent backdoor that survives password resets, MFA enrollment, and even admin account deletion. Detection requires regular app permission audits, which many organizations don&#39;t perform.</div>
            <div class='kill-chain-phases'><div class='kill-chain-phase'><strong>Initial Access:</strong> Admin account compromise (any method)</div><div class='kill-chain-phase'><strong>Persistence:</strong> Create new app registration with Mail.Read, Files.Read.All, Directory.ReadWrite.All</div><div class='kill-chain-phase'><strong>Privilege Escalation:</strong> Grant admin consent to app permissions</div><div class='kill-chain-phase'><strong>Defense Evasion:</strong> App appears legitimate, no user sign-in logs</div><div class='kill-chain-phase'><strong>Impact:</strong> Persistent access surviving password resets and MFA enrollment</div></div>
                        <div class='blast-radius'>
                <span class='blast-label'>Blast Radius:</span>
                <span class='blast-data'>All data accessible via Graph API permissions granted</span>
                <span class='blast-users'>(All users (if directory permissions granted))</span>
            </div>
        </div>        <div class='attack-chain-card severity-high'>
            <div class='attack-chain-header'>
                <span class='attack-chain-severity'>üü† High</span>
                <span class='attack-chain-id'>AC-002</span>
            </div>
            <h4 class='attack-chain-name'>OAuth App Consent Phishing</h4>
            <div class='attack-chain-tactics'><span class='attack-tactic'>Initial Access</span> ‚Üí <span class='attack-tactic'>Collection</span> ‚Üí <span class='attack-tactic'>Exfiltration</span></div>
            <div class='attack-chain-mitre'><span class='mitre-badge'>T1528</span> <span class='mitre-badge'>T1550.001</span> <span class='mitre-badge'>T1114.002</span></div>
            <div class='attack-chain-enablement'>
                <span class='enablement-label'>Enablement:</span>
                <span class='enablement-value'>100%</span>
                <span class='fix-time'>Fix Time: 2 hours</span>
            </div>
            <div class='attack-chain-narrative'>When users can consent to third-party applications, attackers can trick them into granting access to malicious apps disguised as legitimate services. These apps then silently exfiltrate email, files, and calendar data without triggering traditional security alerts. The attack persists until the app is discovered and revoked.</div>
            <div class='kill-chain-phases'><div class='kill-chain-phase'><strong>Initial Access:</strong> Phishing email with OAuth consent link</div><div class='kill-chain-phase'><strong>Execution:</strong> User grants permissions to malicious app</div><div class='kill-chain-phase'><strong>Collection:</strong> App reads emails, calendar, files via Graph API</div><div class='kill-chain-phase'><strong>Exfiltration:</strong> Data continuously synced to attacker infrastructure</div><div class='kill-chain-phase'><strong>Impact:</strong> Silent, persistent data theft without credential compromise</div></div>
                        <div class='blast-radius'>
                <span class='blast-label'>Blast Radius:</span>
                <span class='blast-data'>Email content, Calendar data, Contacts, OneDrive files</span>
                <span class='blast-users'>(Users who consent to malicious app)</span>
            </div>
        </div>        <div class='attack-chain-card severity-high'>
            <div class='attack-chain-header'>
                <span class='attack-chain-severity'>üü† High</span>
                <span class='attack-chain-id'>AC-003</span>
            </div>
            <h4 class='attack-chain-name'>Business Email Compromise (BEC)</h4>
            <div class='attack-chain-tactics'><span class='attack-tactic'>Initial Access</span> ‚Üí <span class='attack-tactic'>Collection</span> ‚Üí <span class='attack-tactic'>Impact</span></div>
            <div class='attack-chain-mitre'><span class='mitre-badge'>T1078</span> <span class='mitre-badge'>T1114</span> <span class='mitre-badge'>T1566.002</span> <span class='mitre-badge'>T1534</span></div>
            <div class='attack-chain-enablement'>
                <span class='enablement-label'>Enablement:</span>
                <span class='enablement-value'>100%</span>
                <span class='fix-time'>Fix Time: 6 hours</span>
            </div>
            <div class='attack-chain-narrative'>Business Email Compromise is the most financially damaging cyberattack type, with billions in losses annually. Attackers compromise employee accounts, monitor financial communications, and then impersonate executives or vendors to redirect payments. Without MFA, mailbox auditing, and email authentication, your organization is highly vulnerable to this attack.</div>
            <div class='kill-chain-phases'><div class='kill-chain-phase'><strong>Initial Access:</strong> Credential theft via phishing or password spray</div><div class='kill-chain-phase'><strong>Execution:</strong> Send fraudulent payment instructions</div><div class='kill-chain-phase'><strong>Persistence:</strong> Create email forwarding rules to external address</div><div class='kill-chain-phase'><strong>Collection:</strong> Monitor email for financial transactions</div><div class='kill-chain-phase'><strong>Impact:</strong> Wire transfer fraud, invoice manipulation</div></div>
                        <div class='blast-radius'>
                <span class='blast-label'>Blast Radius:</span>
                <span class='blast-data'>Email content, Financial records, Vendor/customer data</span>
                <span class='blast-users'>(Finance, executives, accounts payable staff)</span>
            </div>
        </div>        <div class='attack-chain-card severity-high'>
            <div class='attack-chain-header'>
                <span class='attack-chain-severity'>üü† High</span>
                <span class='attack-chain-id'>AC-004</span>
            </div>
            <h4 class='attack-chain-name'>External Data Exfiltration via Sharing</h4>
            <div class='attack-chain-tactics'><span class='attack-tactic'>Collection</span> ‚Üí <span class='attack-tactic'>Exfiltration</span></div>
            <div class='attack-chain-mitre'><span class='mitre-badge'>T1530</span> <span class='mitre-badge'>T1537</span> <span class='mitre-badge'>T1567</span></div>
            <div class='attack-chain-enablement'>
                <span class='enablement-label'>Enablement:</span>
                <span class='enablement-value'>100%</span>
                <span class='fix-time'>Fix Time: 3 hours</span>
            </div>
            <div class='attack-chain-narrative'>When external sharing is unrestricted, any compromised account or malicious insider can exfiltrate sensitive data by simply sharing it externally. This bypasses DLP controls and can lead to intellectual property theft, competitive disadvantage, and regulatory penalties. Restricting external sharing to approved domains significantly reduces this risk.</div>
            <div class='kill-chain-phases'><div class='kill-chain-phase'><strong>Initial Access:</strong> Compromised user account or malicious insider</div><div class='kill-chain-phase'><strong>Collection:</strong> Identify sensitive data in SharePoint/OneDrive</div><div class='kill-chain-phase'><strong>Exfiltration:</strong> Share files/folders externally or sync to personal device</div><div class='kill-chain-phase'><strong>Impact:</strong> Intellectual property theft, regulatory violations</div></div>
                        <div class='blast-radius'>
                <span class='blast-label'>Blast Radius:</span>
                <span class='blast-data'>SharePoint documents, OneDrive files, Teams files</span>
                <span class='blast-users'>(Any user with access to sensitive data)</span>
            </div>
        </div>        <div class='attack-chain-card severity-high'>
            <div class='attack-chain-header'>
                <span class='attack-chain-severity'>üü† High</span>
                <span class='attack-chain-id'>AC-006</span>
            </div>
            <h4 class='attack-chain-name'>Email Spoofing and Impersonation</h4>
            <div class='attack-chain-tactics'><span class='attack-tactic'>Initial Access</span> ‚Üí <span class='attack-tactic'>Defense Evasion</span></div>
            <div class='attack-chain-mitre'><span class='mitre-badge'>T1566.001</span> <span class='mitre-badge'>T1566.002</span> <span class='mitre-badge'>T1534</span></div>
            <div class='attack-chain-enablement'>
                <span class='enablement-label'>Enablement:</span>
                <span class='enablement-value'>100%</span>
                <span class='fix-time'>Fix Time: 4 hours</span>
            </div>
            <div class='attack-chain-narrative'>Without proper email authentication (SPF, DKIM, DMARC), attackers can send emails that appear to come from your domain. These spoofed emails can target your employees, customers, and partners for phishing attacks. Proper DMARC enforcement prevents unauthorized use of your domain and protects your brand reputation.</div>
            <div class='kill-chain-phases'><div class='kill-chain-phase'><strong>Impact:</strong> Credential theft, malware delivery, BEC enablement</div></div>
                        <div class='blast-radius'>
                <span class='blast-label'>Blast Radius:</span>
                <span class='blast-data'>Credentials, Any data disclosed via phishing</span>
                <span class='blast-users'>(All email recipients (internal and external))</span>
            </div>
        </div>
        </div>
        
        <div class='mitre-summary'><h4>üìä MITRE ATT&CK Coverage</h4><p>7 tactics and 15 techniques exploitable</p><div class='tactic-list'><span class='tactic-badge'>Initial Access (4 chains)</span><span class='tactic-badge'>Collection (3 chains)</span><span class='tactic-badge'>Persistence (2 chains)</span><span class='tactic-badge'>Defense Evasion (2 chains)</span><span class='tactic-badge'>Privilege Escalation (2 chains)</span><span class='tactic-badge'>Exfiltration (2 chains)</span><span class='tactic-badge'>Impact (1 chains)</span></div></div>
    </div>
        
        <div class="controls">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search findings...">
                <span class="search-icon">üîç</span>
            </div>
            <div class="filter-group">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="fail">Failed</button>
                <button class="filter-btn" data-filter="warning">Warnings</button>
                <button class="filter-btn" data-filter="pass">Passed</button>
                <button class="filter-btn" data-filter="info">Info</button>
            </div>
        </div>
        
        <div class="results-section">
            <div class="results-header">
                <h2 class="results-title">Detailed Findings</h2>
                <div class="results-count"><span id="visibleCount">8</span> of 8 findings</div>
            </div>
            
            <div class="findings-grid" id="findingsGrid">
                <div class="finding-card" data-status="fail">
    <div class="finding-header">
        <div class="finding-title-group">
            <div class="finding-name">MFA Enforcement</div>
            <div class="finding-badges">
                <span class="badge badge-category">Security</span>
                <span class="badge badge-status-fail">Fail</span>
                <span class="badge badge-severity-critical">Critical</span>
            </div>
        </div>
    </div>
    <div class="finding-body">
        <div class="finding-section">
            <div class="finding-label">Finding</div>
            <div class="finding-content"><div class='mfa-summary'><div class='mfa-stat'><span class='mfa-label'>Adoption</span><span class='mfa-value'>N/A</span></div><div class='mfa-stat'><span class='mfa-label'>Users With MFA</span><span class='mfa-value'></span></div><div class='mfa-stat'><span class='mfa-label'>Users Without MFA</span><span class='mfa-value'></span></div><div class='mfa-stat'><span class='mfa-label'>Target Threshold</span><span class='mfa-value'>N/A</span></div></div><br><br><strong>Users without MFA (2):</strong><br><table style='width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 13px;'><tr style='background: var(--gray-100); font-weight: 600;'><td style='padding: 8px; border: 1px solid var(--gray-300);'>Item</td></tr><tr><td style='padding: 8px; border: 1px solid var(--gray-300);'><code>user1@contoso.com</code> - User One</td></tr><tr><td style='padding: 8px; border: 1px solid var(--gray-300);'><code>user2@contoso.com</code> - User Two</td></tr></table></div>
        </div>
        <div class="finding-section">
            <div class="finding-label">Recommendation</div>
            <div class="finding-content">Enable MFA for all users immediately</div>
        </div>
        <div class="finding-section">
            <a href="https://learn.microsoft.com/en-us/entra/identity/authentication/concept-mfa-howitworks" target="_blank" class="doc-link">
                <span>üìò</span>
                <span>View Documentation</span>
            </a>
        </div>
    </div>
</div>
<div class="finding-card" data-status="warning">
    <div class="finding-header">
        <div class="finding-title-group">
            <div class="finding-name">Privileged Account Security</div>
            <div class="finding-badges">
                <span class="badge badge-category">Security</span>
                <span class="badge badge-status-warning">Warning</span>
                <span class="badge badge-severity-high">High</span>
            </div>
        </div>
    </div>
    <div class="finding-body">
        <div class="finding-section">
            <div class="finding-label">Finding</div>
            <div class="finding-content">8 global administrators found; recommend limiting count to 2-3<br><br><strong>Privileged Accounts (1):</strong><br><table style='width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 13px;'><tr style='background: var(--gray-100); font-weight: 600;'><td style='padding: 8px; border: 1px solid var(--gray-300);'>User Principal Name</td><td style='padding: 8px; border: 1px solid var(--gray-300);'>Roles</td><td style='padding: 8px; border: 1px solid var(--gray-300);'>MFA Status</td></tr><tr><td style='padding: 8px; border: 1px solid var(--gray-300);'><code>admin1@contoso.com</code></td><td style='padding: 8px; border: 1px solid var(--gray-300); font-size: 12px;'></td><td style='padding: 8px; border: 1px solid var(--gray-300); color: var(--danger-color); font-weight: 600;'>‚ùå Not Enabled</td></tr></table></div>
        </div>
        <div class="finding-section">
            <div class="finding-label">Recommendation</div>
            <div class="finding-content">Reduce global admin count and use Privileged Identity Management</div>
        </div>
        <div class="finding-section">
            <a href="https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/best-practices" target="_blank" class="doc-link">
                <span>üìò</span>
                <span>View Documentation</span>
            </a>
        </div>
    </div>
</div>
<div class="finding-card" data-status="fail">
    <div class="finding-header">
        <div class="finding-title-group">
            <div class="finding-name">Legacy Authentication</div>
            <div class="finding-badges">
                <span class="badge badge-category">Security</span>
                <span class="badge badge-status-fail">Fail</span>
                <span class="badge badge-severity-high">High</span>
            </div>
        </div>
    </div>
    <div class="finding-body">
        <div class="finding-section">
            <div class="finding-label">Finding</div>
            <div class="finding-content">Legacy authentication not blocked; 8 sign-ins detected</div>
        </div>
        <div class="finding-section">
            <div class="finding-label">Recommendation</div>
            <div class="finding-content">Block legacy authentication immediately</div>
        </div>
        <div class="finding-section">
            <a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/block-legacy-authentication" target="_blank" class="doc-link">
                <span>üìò</span>
                <span>View Documentation</span>
            </a>
        </div>
    </div>
</div>
<div class="finding-card" data-status="warning">
    <div class="finding-header">
        <div class="finding-title-group">
            <div class="finding-name">Conditional Access Policies</div>
            <div class="finding-badges">
                <span class="badge badge-category">Security</span>
                <span class="badge badge-status-warning">Warning</span>
                <span class="badge badge-severity-high">High</span>
            </div>
        </div>
    </div>
    <div class="finding-body">
        <div class="finding-section">
            <div class="finding-label">Finding</div>
            <div class="finding-content">Only 3 of 5 recommended CA policies enabled</div>
        </div>
        <div class="finding-section">
            <div class="finding-label">Recommendation</div>
            <div class="finding-content">Enable additional CA policies for better coverage</div>
        </div>
        <div class="finding-section">
            <a href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/overview" target="_blank" class="doc-link">
                <span>üìò</span>
                <span>View Documentation</span>
            </a>
        </div>
    </div>
</div>
<div class="finding-card" data-status="fail">
    <div class="finding-header">
        <div class="finding-title-group">
            <div class="finding-name">Application Permissions Audit</div>
            <div class="finding-badges">
                <span class="badge badge-category">Security</span>
                <span class="badge badge-status-fail">Fail</span>
                <span class="badge badge-severity-medium">Medium</span>
            </div>
        </div>
    </div>
    <div class="finding-body">
        <div class="finding-section">
            <div class="finding-label">Finding</div>
            <div class="finding-content">User consent for apps is enabled; 15 risky apps detected<br><br><strong>Risky Applications (1):</strong><br><table style='width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 13px;'><tr style='background: var(--gray-100); font-weight: 600;'><td style='padding: 8px; border: 1px solid var(--gray-300);'>Application</td><td style='padding: 8px; border: 1px solid var(--gray-300);'>Type</td><td style='padding: 8px; border: 1px solid var(--gray-300);'>Risk Reasons</td><td style='padding: 8px; border: 1px solid var(--gray-300);'>High-Risk Permissions</td></tr><tr><td style='padding: 8px; border: 1px solid var(--gray-300);'><code>Suspicious App</code></td><td style='padding: 8px; border: 1px solid var(--gray-300);'></td><td style='padding: 8px; border: 1px solid var(--gray-300); color: var(--danger-color);'></td><td style='padding: 8px; border: 1px solid var(--gray-300); font-size: 11px;'>-</td></tr></table></div>
        </div>
        <div class="finding-section">
            <div class="finding-label">Recommendation</div>
            <div class="finding-content">Disable user consent and audit high-privilege apps</div>
        </div>
        <div class="finding-section">
            <a href="https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/configure-user-consent" target="_blank" class="doc-link">
                <span>üìò</span>
                <span>View Documentation</span>
            </a>
        </div>
    </div>
</div>
<div class="finding-card" data-status="fail">
    <div class="finding-header">
        <div class="finding-title-group">
            <div class="finding-name">Email Authentication (SPF/DKIM/DMARC)</div>
            <div class="finding-badges">
                <span class="badge badge-category">Exchange</span>
                <span class="badge badge-status-fail">Fail</span>
                <span class="badge badge-severity-high">High</span>
            </div>
        </div>
    </div>
    <div class="finding-body">
        <div class="finding-section">
            <div class="finding-label">Finding</div>
            <div class="finding-content">DMARC not enforced for domain contoso.com<br><br><strong>Domain Email Authentication Details:</strong><br><table style='width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 13px;'><tr style='background: var(--gray-100); font-weight: 600;'><td style='padding: 8px; border: 1px solid var(--gray-300);'>Domain</td><td style='padding: 8px; border: 1px solid var(--gray-300);'>SPF</td><td style='padding: 8px; border: 1px solid var(--gray-300);'>DKIM</td><td style='padding: 8px; border: 1px solid var(--gray-300);'>DMARC</td></tr><tr><td style='padding: 8px; border: 1px solid var(--gray-300);'><code>contoso.com</code></td><td style='padding: 8px; border: 1px solid var(--gray-300);'><span style='display:inline-block;width:10px;height:10px;border-radius:50%;background:#8a8886;'></span> Configured</td><td style='padding: 8px; border: 1px solid var(--gray-300);'><span style='display:inline-block;width:10px;height:10px;border-radius:50%;background:#107c10;'></span> Enabled</td><td style='padding: 8px; border: 1px solid var(--gray-300);'><span style='display:inline-block;width:10px;height:10px;border-radius:50%;background:#8a8886;'></span> Not Enforced</td></tr></table></div>
        </div>
        <div class="finding-section">
            <div class="finding-label">Recommendation</div>
            <div class="finding-content">Enforce DMARC policy for domain protection</div>
        </div>
        <div class="finding-section">
            <a href="https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-about" target="_blank" class="doc-link">
                <span>üìò</span>
                <span>View Documentation</span>
            </a>
        </div>
    </div>
</div>
<div class="finding-card" data-status="warning">
    <div class="finding-header">
        <div class="finding-title-group">
            <div class="finding-name">Mailbox Auditing</div>
            <div class="finding-badges">
                <span class="badge badge-category">Exchange</span>
                <span class="badge badge-status-warning">Warning</span>
                <span class="badge badge-severity-medium">Medium</span>
            </div>
        </div>
    </div>
    <div class="finding-body">
        <div class="finding-section">
            <div class="finding-label">Finding</div>
            <div class="finding-content">Mailbox auditing is not enabled for all mailboxes; 12 non-compliant<br><br><strong>Non-Compliant Mailboxes (1):</strong><br><table style='width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 13px;'><tr style='background: var(--gray-100); font-weight: 600;'><td style='padding: 8px; border: 1px solid var(--gray-300);'>Item</td></tr><tr><td style='padding: 8px; border: 1px solid var(--gray-300);'><code></code> - Unaudited User</td></tr></table></div>
        </div>
        <div class="finding-section">
            <div class="finding-label">Recommendation</div>
            <div class="finding-content">Enable mailbox auditing for all mailboxes</div>
        </div>
        <div class="finding-section">
            <a href="https://learn.microsoft.com/en-us/microsoft-365/compliance/enable-mailbox-auditing" target="_blank" class="doc-link">
                <span>üìò</span>
                <span>View Documentation</span>
            </a>
        </div>
    </div>
</div>
<div class="finding-card" data-status="fail">
    <div class="finding-header">
        <div class="finding-title-group">
            <div class="finding-name">External Sharing Configuration</div>
            <div class="finding-badges">
                <span class="badge badge-category">Security</span>
                <span class="badge badge-status-fail">Fail</span>
                <span class="badge badge-severity-high">High</span>
            </div>
        </div>
    </div>
    <div class="finding-body">
        <div class="finding-section">
            <div class="finding-label">Finding</div>
            <div class="finding-content">External sharing is unrestricted; anyone can share</div>
        </div>
        <div class="finding-section">
            <div class="finding-label">Recommendation</div>
            <div class="finding-content">Restrict external sharing to approved domains</div>
        </div>
        <div class="finding-section">
            <a href="https://learn.microsoft.com/en-us/sharepoint/external-sharing-overview" target="_blank" class="doc-link">
                <span>üìò</span>
                <span>View Documentation</span>
            </a>
        </div>
    </div>
</div>

            </div>
        </div>
    </div>
    
    <script>
        // Chart.js configuration
        const statusData = {
            labels: ['Passed', 'Failed', 'Warning', 'Info'],
            datasets: [{
                data: [0, 5, 3, 0],
                backgroundColor: ['#107c10', '#d13438', '#ff8c00', '#0078d4'],
                borderWidth: 0
            }]
        };
        
        const severityData = {
            labels: ['Critical', 'High', 'Medium'],
            datasets: [{
                label: 'Findings',
                data: [1, 5, 2],
                backgroundColor: ['#d13438', '#ff8c00', '#ffd700', '#90ee90', '#e1f5fe'],
                borderWidth: 0
            }]
        };
        
        new Chart(document.getElementById('statusChart'), {
            type: 'doughnut',
            data: statusData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' }
                }
            }
        });
        
        new Chart(document.getElementById('severityChart'), {
            type: 'bar',
            data: severityData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: { beginAtZero: true, ticks: { precision: 0 } }
                }
            }
        });
        
        // Search and filter functionality
        const searchInput = document.getElementById('searchInput');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const findingCards = document.querySelectorAll('.finding-card');
        const visibleCount = document.getElementById('visibleCount');
        
        let currentFilter = 'all';
        
        function updateVisibleCount() {
            const visible = document.querySelectorAll('.finding-card:not([style*="display: none"])').length;
            visibleCount.textContent = visible;
        }
        
        function filterFindings() {
            const searchTerm = searchInput.value.toLowerCase();
            
            findingCards.forEach(card => {
                const text = card.textContent.toLowerCase();
                const matchesSearch = text.includes(searchTerm);
                const status = card.dataset.status;
                const matchesFilter = currentFilter === 'all' || status === currentFilter;
                
                card.style.display = matchesSearch && matchesFilter ? 'block' : 'none';
            });
            
            updateVisibleCount();
        }
        
        searchInput.addEventListener('input', filterFindings);
        
        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                filterBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                filterFindings();
            });
        });
    </script>
</body>
</html>

